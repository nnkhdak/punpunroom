<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Expires" content="0">
	<meta charset="utf-8" />
	<base href="../">
	<link rel="stylesheet" type="text/css" href="assets/style.css" />
	<style>
		/* 画面毎設定 */
		.width1 {
			width: 100px;
		}

		.width2 {
			width: 150px;
		}

		code {
			display: block;
			white-space: pre;
		}

		main ol li {
			margin-top: 1em;
		}
	</style>
</head>

<body>
	<noscript>
		<p>JavaScriptがサポートされていないため表示できません。</p>
	</noscript>
	<header></header>
	<main style="display: none;">
		<div id="mainLeft"></div>
		<div id="mainCenter">
			<h2>Oracle</h2>
			<ul>
				<li>
					自分のテーブルにMERGE<br />
					<code>MERGE INTO <i>テーブル名</i> USING dual
ON <strong>(</strong><i>項目</i> = <i>値</i><strong>)</strong>
WHEN MATCHED THEN UPDATE SET
  項目1</i> = <i>値1</i>
, 項目2</i> = <i>値2</i>
WHEN NOT MATCHED THEN INSERT (
  <i>項目1</i>
, <i>項目2</i>
) VALUES (
  <i>値1</i>
, <i>値2</i>
)</code>
				</li>
				<li>
					Select結果を使ってUPDATE(Mergeを使う)<br />
					<br />
					<code>MERGE INTO
	更新したいテーブル名 t0
USING (
	SELECT
		  取得する項目1
		, 取得する項目2
	FROM
		テーブル１ t1
		JOIN テーブル２	t2 ON 結合条件
	WHERE
		検索条件(1行になるように)
	) tmp
ON (
	更新したい条件
)
WHEN MATCHED THEN UPDATE
SET
	  更新する項目1 = 取得する項目1
	, 更新する項目2 = 取得する項目2</code>
				</li>
				<li>
					日付フォーマット<br />
					<code>TO_CHAR(CURRENT_DATE, 'YYYY/MM/DD HH24:MI:SS')</code>
				</li>
				<li>
					テーブル構造が同じテーブルを作成＆データのコピー<br />
					<code>CREATE TABLE <i><strong>新table_name</strong></i> AS SELECT * FROM <i><strong>旧table_name</strong></i></code>
				</li>
				<li>
					テーブルの完全削除<br />
					<code>DROP TABLE <i><strong>table_name</strong></i> CASCADE CONSTRAINTS PURGE;</code>
				</li>
				<li>
					?件数の架空のテーブルをSELECT<br />
					<code>SELECT <strong>LEVEL</strong> AS lv FROM DUAL <strong>CONNECT BY LEVEL</strong> &lt;= 3;</code>
				</li>
				<li>
					テーブル名を表示<br />
					<code>SELECT <strong>table_name</strong> FROM all_tables ORDER BY <strong>table_name</strong>;</code>
					<code>SELECT <strong>table_name</strong> FROM user_tables ORDER BY <strong>table_name</strong>;</code>
				</li>
				<li>
					テーブル構造を表示<br />
					<code>DESC <i><strong>table_name</strong></i>;</code>
				</li>
				<li>
					シノニムを表示<br />
					<code>SELECT * FROM all_synonyms;</code>
					<code>SELECT * FROM user_synonyms;</code>
				</li>
				<li>
					sqlplusで接続<br />
					<code>sqlplus <i>ユーザ名</i>@<i>サーバ名</i></code>
					<code>sqlplus <i>ユーザ名</i>@<i><strong>net_service_name</strong></i></code>
				</li>
				<li>
					tnsnames.ora<br />
					<code><i><strong>net_service_name</strong></i> =
(DESCRIPTION =
(ADDRESS = (PROTOCOL = TCP)(HOST = myserver.mycompany.com)(PORT = 1521))
(CONNECT_DATA =
  (SERVER = DEDICATED)
  (SERVICE_NAME = orcl)
)
)</code>
				</li>
				<li>
					tnsnames.oraに複数回定義する<br />
					<code><i><strong>net_service_name1</strong></i> =
(DESCRIPTION = ......)
<i><strong>net_service_name2</strong></i> =
(DESCRIPTION = ......)</code>
				</li>
				<li>
					折り返し行？を設定<br />
					<code>SET LINE <i>行数</i>;</code>
				</li>
				<li>
					SQL Developer<br />
					<code>メニューバー ＞ ツール ＞ プリファレンスを選択
プリファレンスダイアログ　＞　データベース　＞　オブジェクト・ビューアを選択
「データベース：オブジェクト・ビューア」　＞　「オブジェクト・ビューア・ウィンドウの自動固定」にチェックを入れる</code>
					<code>メニューバー ＞ ツール ＞ プリファレンスを選択
プリファレンスダイアログ　＞　データベース　＞　オブジェクト・ビューアを選択
「データベース：オブジェクト・ビューア」　＞　「シングル・クリックでオブジェクトをオープン」のチェックをはずす</code>
				</li>
				<li>
					AmazonLinux2にインストールし設定<br />
					<br />
					/etc/environmentに以下を追記
					<code>LANG=ja_JP.UTF-8
NLS_LANG=Japanese_Japan.AL32UTF8
ENVIRONMENT=development<strong> &lt;- これは違う目的</strong></code>
					<br />
					/etc/profile.d/oracle.shを作成(ココに配置することで/etc/profileに記述したときと同じ扱い)
					<code>export NLS_LANG=Japanese_Japan.AL32UTF8
export LD_LIBRARY_PATH=/opt/oracle/instantclient_19_6
export PATH=$PATH:$LD_LIBRARY_PATH</code>
					<br />
					systemctl edit
					httpd.service(コレで保存すると/etc/systemd/system/httpd.service.d/override.confに保存したときと同じ扱い)
					<code>[Service]
EnvironmentFile=/etc/environment</code>
				</li>
			</ul>
		</div>
		<div id="mainRight"></div>
	</main>
	<footer></footer>
</body>
<script src="assets/script.js"></script>

</html>